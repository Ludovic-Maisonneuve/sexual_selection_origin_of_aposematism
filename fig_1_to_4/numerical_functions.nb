(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24276,        630]
NotebookOptionsPosition[     23920,        616]
NotebookOutlinePosition[     24320,        632]
CellTagsIndexPosition[     24277,        629]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"NumSeq", "[", 
   RowBox[{"min_", ",", " ", "max_", ",", " ", "nstep_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{"x", ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "min", ",", " ", "max", ",", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"max", "-", "min"}], ")"}], "/", "nstep"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeRule", "[", 
    RowBox[{"targets_", ",", " ", "subs_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"targets", ",", " ", "subs"}], "}"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DropParam", "[", 
    RowBox[{"params_", ",", " ", "param_"}], "]"}], ":=", 
   RowBox[{"Drop", "[", 
    RowBox[{"params", ",", 
     RowBox[{"First", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", " ", "params"}], 
         "]"}], ",", " ", "param"}], "]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParamSerialize", "[", 
    RowBox[{"params_", ",", " ", "param_", ",", " ", "seq_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"params2", ",", " ", "paramlist"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"params2", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"params", ",", 
         RowBox[{"First", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", " ", "params"}], 
             "]"}], ",", " ", "param"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"paramlist", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"param", " ", "\[Rule]", " ", "#"}], "}"}], ",", " ", 
            "params2"}], "]"}], "&"}], ",", " ", "seq"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "paramlist"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelGradIterate", "[", 
    RowBox[{"S_", ",", " ", "traits_", ",", " ", "params_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vars", ",", "init", ",", "bounds", ",", "Sparams", ",", "G", ",", 
       "myclip", ",", " ", "newval"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "&"}], ",", " ", "traits"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"init", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", " ", "traits"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bounds", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"3", ",", "4"}], "}"}], "]"}], "]"}], "&"}], ",", " ", 
         "traits"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sparams", "=", 
       RowBox[{
        RowBox[{"S", "/.", "params"}], "//", "Simplify"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"G", "=", 
       RowBox[{"0.001", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Length", "[", "S", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myclip", "[", 
        RowBox[{"val_", ",", " ", "pos_"}], "]"}], ":=", " ", 
       RowBox[{"Clip", "[", 
        RowBox[{"val", ",", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"bounds", "[", 
           RowBox[{"[", "pos", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newval", "[", "val_", "]"}], ":=", " ", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{"myclip", ",", " ", 
         RowBox[{"val", "+", 
          RowBox[{"G", ".", 
           RowBox[{"(", 
            RowBox[{"Sparams", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", " ", "val"}], "]"}]}], ")"}]}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NestWhileList", "[", 
       RowBox[{"newval", ",", "init", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], ">", 
          RowBox[{"10", "^", 
           RowBox[{"-", "5"}]}]}], "&"}], ",", "2", ",", "1000000"}], 
       "]"}]}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelGradIterateFor", "[", 
    RowBox[{"S_", ",", " ", "traits_", ",", " ", "params_", ",", " ", "n_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vars", ",", "init", ",", "bounds", ",", "Sparams", ",", "G", ",", 
       "myclip", ",", " ", "newval"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "&"}], ",", " ", "traits"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"init", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", " ", "traits"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bounds", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"3", ",", "4"}], "}"}], "]"}], "]"}], "&"}], ",", " ", 
         "traits"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sparams", "=", 
       RowBox[{
        RowBox[{"S", "/.", "params"}], "//", "Simplify"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"G", "=", 
       RowBox[{"0.001", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Length", "[", "vars", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myclip", "[", 
        RowBox[{"val_", ",", " ", "pos_"}], "]"}], ":=", " ", 
       RowBox[{"Clip", "[", 
        RowBox[{"val", ",", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"bounds", "[", 
           RowBox[{"[", "pos", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newval", "[", "val_", "]"}], ":=", " ", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{"myclip", ",", " ", 
         RowBox[{"val", "+", 
          RowBox[{"G", ".", 
           RowBox[{"(", 
            RowBox[{"Sparams", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", " ", "val"}], "]"}]}], ")"}]}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NestList", "[", 
       RowBox[{"newval", ",", "init", ",", "n"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetReachedStrat", "[", 
    RowBox[{"S_", ",", " ", "traits_", ",", " ", "params_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "timedyn", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timedyn", " ", "=", " ", 
       RowBox[{"SelGradIterate", "[", 
        RowBox[{"S", ",", " ", "traits", ",", " ", "params"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Last", "[", "timedyn", "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotDyn", "[", 
    RowBox[{"S_", ",", " ", "traits_", ",", " ", "params_", ",", "style_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vars", ",", "timedyn"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "&"}], ",", " ", "traits"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"timedyn", " ", "=", " ", 
       RowBox[{"SelGradIterate", "[", 
        RowBox[{"S", ",", " ", "traits", ",", " ", "params"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TableDyn", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"timedyn", "[", 
            RowBox[{"[", 
             RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "S", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "1", ",", " ", 
           RowBox[{
            RowBox[{"Dimensions", "[", "timedyn", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"TableDyn", ",", " ", 
        RowBox[{"PlotLegends", "\[Rule]", "vars"}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "style"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "All"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotDynFor", "[", 
    RowBox[{
    "S_", ",", " ", "traits_", ",", " ", "params_", ",", "style_", ",", 
     "n_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vars", ",", "timedyn"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "&"}], ",", " ", "traits"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"timedyn", " ", "=", " ", 
       RowBox[{"SelGradIterateFor", "[", 
        RowBox[{"S", ",", " ", "traits", ",", " ", "params", ",", "n"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TableDyn", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"timedyn", "[", 
            RowBox[{"[", 
             RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "S", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "1", ",", " ", 
           RowBox[{
            RowBox[{"Dimensions", "[", "timedyn", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"TableDyn", ",", " ", 
        RowBox[{"PlotLegends", "\[Rule]", "vars"}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "style"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "All"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotDynTwoStep", "[", 
    RowBox[{"S_", ",", " ", "params_", ",", "style_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vars", ",", "timedyn", ",", " ", "S1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"S1", "=", "S"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"S1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"timedyn1", " ", "=", 
       RowBox[{"SelGradIterateFor", "[", 
        RowBox[{"S1", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s", ",", "0", ",", "0", ",", "1000"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"d", ",", "0", ",", "0", ",", "1000"}], "}"}]}], "}"}], 
         ",", " ", "params", ",", " ", "5000"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"timedyn2", "=", 
       RowBox[{"SelGradIterateFor", "[", 
        RowBox[{"S", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s", ",", 
             RowBox[{
              RowBox[{"Last", "[", "timedyn1", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "1000"}], "}"}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{"d", ",", "0", ",", "0", ",", "1000"}], "}"}]}], "}"}], 
         ",", " ", "params", ",", " ", "5000"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TableDyn", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"t", "<=", "1000"}], ",", 
             RowBox[{"timedyn1", "[", 
              RowBox[{"[", 
               RowBox[{"t", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"timedyn2", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"t", "-", "1000"}], ",", "i"}], "]"}], "]"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "S", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "1", ",", " ", "2000"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"TableDyn", ",", " ", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<s\>\"", ",", "\"\<d\>\""}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "style"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "All"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetParamImpact", "[", 
    RowBox[{
    "S_", ",", "H_", ",", " ", "traits_", ",", " ", "params_", ",", " ", 
     "param_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vars", ",", "par", ",", "paramsDrop", ",", " ", "data", ",", "dataH", 
       ",", " ", "imax", ",", " ", "array", ",", " ", "datatraits"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "&"}], ",", " ", "traits"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"par", "=", 
       RowBox[{"param", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"paramsDrop", "=", 
       RowBox[{"DropParam", "[", 
        RowBox[{"params", ",", "par"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"data", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pp", ",", 
           RowBox[{
            RowBox[{"GetReachedStrat", "[", 
             RowBox[{"S", ",", " ", "traits", ",", "  ", 
              RowBox[{"Insert", "[", 
               RowBox[{"paramsDrop", ",", 
                RowBox[{"par", "\[Rule]", "pp"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "S", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pp", ",", 
           RowBox[{"param", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"param", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"param", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"imax", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"param", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"param", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", 
         RowBox[{"param", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "+", "1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"array", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"par", ",", "param"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dataH", " ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"array", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{"Eigenvalues", "[", 
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"H", "/.", "paramsDrop"}], "/.", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", 
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}]}], 
                 "]"}]}], "/.", 
               RowBox[{"{", 
                RowBox[{"par", "\[Rule]", 
                 RowBox[{"array", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "imax", ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"data", ",", "dataH"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotParamImpact", "[", 
   RowBox[{
   "S_", ",", " ", "H_", ",", "traits_", ",", " ", "params_", ",", " ", 
    "param_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vars", ",", "Listdata", ",", "data", ",", " ", "dataH", ",", " ", "p1", 
      ",", " ", "p2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vars", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], "&"}], ",", " ", "traits"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Listdata", " ", "=", " ", 
      RowBox[{"GetParamImpact", "[", 
       RowBox[{
       "S", ",", " ", "H", ",", "traits", ",", " ", "params", ",", " ", 
        "param"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Listdata", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dataH", "=", 
      RowBox[{"Listdata", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"data", ",", 
        RowBox[{"PlotLegends", "\[Rule]", "vars"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"param", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<traits\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p2", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"dataH", ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"param", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           "\"\<Leading eigenvalue H\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GraphicsRow", "[", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.904893336918106*^9, 3.904893364842763*^9}, {
   3.904903832903755*^9, 3.90490383343701*^9}, {3.9053255763749113`*^9, 
   3.905325593365987*^9}, {3.9053289796797*^9, 3.90532899808144*^9}, {
   3.905419571690062*^9, 3.905419578151766*^9}, {3.905419617378564*^9, 
   3.905419635591043*^9}, {3.905419890341957*^9, 3.905419890659937*^9}, 
   3.905506410283573*^9, {3.9055064690493107`*^9, 3.905506578825881*^9}, {
   3.905510686389717*^9, 3.9055106893796177`*^9}, {3.9064331894724417`*^9, 
   3.906433190885928*^9}, {3.906436118836067*^9, 3.906436119412641*^9}, {
   3.906436490355813*^9, 3.906436528294322*^9}, {3.906436667974414*^9, 
   3.906436670043639*^9}, {3.9080171673035727`*^9, 3.908017177975835*^9}, {
   3.908017216960656*^9, 3.908017307752365*^9}, {3.908017395883998*^9, 
   3.908017438395658*^9}, {3.90801764422723*^9, 3.908017652191992*^9}, {
   3.908017727310429*^9, 3.908017752225418*^9}, {3.908017788463888*^9, 
   3.908018024440894*^9}, {3.908018081100374*^9, 3.9080181226332417`*^9}, {
   3.908018516304696*^9, 3.9080185400386066`*^9}, {3.908018595671818*^9, 
   3.908018672669595*^9}, 3.9080187026721153`*^9, {3.908018765376802*^9, 
   3.9080187969773417`*^9}, 3.9080189511129417`*^9, {3.908019084103718*^9, 
   3.908019084526588*^9}, {3.908019156397801*^9, 3.90801916991228*^9}, {
   3.908021112646573*^9, 3.908021124976615*^9}, {3.90802116616814*^9, 
   3.908021174971634*^9}, {3.908021271505019*^9, 3.908021274583129*^9}, {
   3.908021497276613*^9, 3.908021521068639*^9}, {3.90802158228363*^9, 
   3.908021616705785*^9}, {3.908021694566798*^9, 3.908021695539178*^9}, {
   3.910942975961274*^9, 3.910942980789431*^9}, {3.91708936539961*^9, 
   3.917089397170514*^9}, {3.9244908244134283`*^9, 3.924490830077979*^9}, {
   3.924496385702332*^9, 3.924496387236311*^9}, {3.924509765943713*^9, 
   3.924509766838656*^9}, {3.924523001063747*^9, 3.924523026469515*^9}, {
   3.92466526464911*^9, 3.924665265702674*^9}, {3.924665299549157*^9, 
   3.924665318815034*^9}, {3.924667142171246*^9, 3.924667178927465*^9}, 
   3.924668115151578*^9, {3.9246681919093943`*^9, 3.9246682117223663`*^9}, 
   3.9246682581504498`*^9, {3.9246682901395187`*^9, 3.924668397161572*^9}, {
   3.925278153393824*^9, 3.9252781711633587`*^9}, {3.9331683523144493`*^9, 
   3.933168353010497*^9}, {3.933168595941081*^9, 3.933168600838784*^9}, {
   3.9331686616530447`*^9, 3.9331686624548817`*^9}, {3.933168696076453*^9, 
   3.933168696496645*^9}, {3.934625491492836*^9, 
   3.9346255103549747`*^9}},ExpressionUUID->"566f8f1a-1f53-4652-bdeb-\
db47045c6e65"]
},
WindowSize->{1512, 831},
WindowMargins->{{1676, Automatic}, {Automatic, 56}},
FrontEndVersion->"13.0 pour Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"28078c1b-1575-44c9-8711-f4c6d233a0a0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 23358, 594, 2536, "Input",ExpressionUUID->"566f8f1a-1f53-4652-bdeb-db47045c6e65"]
}
]
*)

